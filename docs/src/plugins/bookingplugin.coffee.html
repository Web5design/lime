<!DOCTYPE html><html><head><title>bookingplugin.coffee</title><meta http-equiv="Content-Type" content="text/html" charset="UTF-8"><link rel="stylesheet" media="all" href="../../docco.css"></head><body><div id="container"><div id="background"></div><div id="jump_to">Jump To &hellip;<div id="jump_wrapper"><div id="jump_page"><a href="../../index.html" class="source"><span class="file_name">README</span></a><a href="../../src/annotation.coffee.html" class="source "><span class="base_path">src / </span><span class="file_name">annotation.coffee</span></a><a href="../../src/annotationoverlays.coffee.html" class="source "><span class="base_path">src / </span><span class="file_name">annotationoverlays.coffee</span></a><a href="../../src/cmf.coffee.html" class="source "><span class="base_path">src / </span><span class="file_name">cmf.coffee</span></a><a href="../../src/jquery.scrollTo.coffee.html" class="source "><span class="base_path">src / </span><span class="file_name">jquery.scrollTo.coffee</span></a><a href="../../src/lime.coffee.html" class="source "><span class="base_path">src / </span><span class="file_name">lime.coffee</span></a><a href="../../src/plugin.coffee.html" class="source "><span class="base_path">src / </span><span class="file_name">plugin.coffee</span></a><a href="../../src/plugins/actorplugin.coffee.html" class="source "><span class="base_path">src / plugins / </span><span class="file_name">actorplugin.coffee</span></a><a href="../../src/plugins/bookingplugin.coffee.html" class="source selected"><span class="base_path">src / plugins / </span><span class="file_name">bookingplugin.coffee</span></a><a href="../../src/plugins/businessplugin.coffee.html" class="source "><span class="base_path">src / plugins / </span><span class="file_name">businessplugin.coffee</span></a><a href="../../src/plugins/characterplugin.coffee.html" class="source "><span class="base_path">src / plugins / </span><span class="file_name">characterplugin.coffee</span></a><a href="../../src/plugins/dbpediainfoplugin.coffee.html" class="source "><span class="base_path">src / plugins / </span><span class="file_name">dbpediainfoplugin.coffee</span></a><a href="../../src/plugins/directorplugin.coffee.html" class="source "><span class="base_path">src / plugins / </span><span class="file_name">directorplugin.coffee</span></a><a href="../../src/plugins/geonamesmapplugin.coffee.html" class="source "><span class="base_path">src / plugins / </span><span class="file_name">geonamesmapplugin.coffee</span></a><a href="../../src/plugins/googleweatherplugin.coffee.html" class="source "><span class="base_path">src / plugins / </span><span class="file_name">googleweatherplugin.coffee</span></a><a href="../../src/plugins/help.coffee.html" class="source "><span class="base_path">src / plugins / </span><span class="file_name">help.coffee</span></a><a href="../../src/plugins/ldplugin.coffee.html" class="source "><span class="base_path">src / plugins / </span><span class="file_name">ldplugin.coffee</span></a><a href="../../src/plugins/ldplugin.coffee.html" class="source "><span class="base_path">src / plugins / </span><span class="file_name">ldplugin.coffee</span></a><a href="../../src/plugins/lsiimageplugin.coffee.html" class="source "><span class="base_path">src / plugins / </span><span class="file_name">lsiimageplugin.coffee</span></a><a href="../../src/plugins/lsivideoplugin.coffee.html" class="source "><span class="base_path">src / plugins / </span><span class="file_name">lsivideoplugin.coffee</span></a><a href="../../src/plugins/mediaplugin.coffee.html" class="source "><span class="base_path">src / plugins / </span><span class="file_name">mediaplugin.coffee</span></a><a href="../../src/plugins/objectplugin.coffee.html" class="source "><span class="base_path">src / plugins / </span><span class="file_name">objectplugin.coffee</span></a><a href="../../src/plugins/tvplugin.coffee.html" class="source "><span class="base_path">src / plugins / </span><span class="file_name">tvplugin.coffee</span></a><a href="../../src/plugins/videoplugin.coffee.html" class="source "><span class="base_path">src / plugins / </span><span class="file_name">videoplugin.coffee</span></a><a href="../../src/plugins/youtubeplugin.coffee.html" class="source "><span class="base_path">src / plugins / </span><span class="file_name">youtubeplugin.coffee</span></a><a href="../../src/videojs-adapter.coffee.html" class="source "><span class="base_path">src / </span><span class="file_name">videojs-adapter.coffee</span></a><a href="../../src/widget.coffee.html" class="source "><span class="base_path">src / </span><span class="file_name">widget.coffee</span></a></div></div></div><table cellpadding="0" cellspacing="0"><thead><tr><th class="docs"><h1>bookingplugin.coffee</h1><div class="filepath">src/plugins/</div></th><th class="code"></th></tr></thead><tbody><tr id="section-1"><td class="docs"><div class="pilwrap"><a href="#section-1" class="pilcrow">&#182;</a></div>
</td><td class="code"><div class="highlight"><pre><span class="k">class</span> <span class="nb">window</span><span class="p">.</span><span class="nx">BookingPlugin</span> <span class="k">extends</span> <span class="nb">window</span><span class="p">.</span><span class="nx">LimePlugin</span>
  <span class="nv">init: </span><span class="o">-&gt;</span>
    <span class="vi">@name = </span><span class="s">&#39;BookingPlugin&#39;</span>
    <span class="nv">annotation = </span><span class="kc">undefined</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">info</span> <span class="s">&quot;Initialize BusinessPlugin&quot;</span>

    <span class="k">for</span> <span class="nx">annotation</span> <span class="k">in</span> <span class="nx">@lime</span><span class="p">.</span><span class="nx">annotations</span>
      <span class="k">if</span> <span class="nx">annotation</span><span class="p">.</span><span class="nx">resource</span><span class="p">.</span><span class="nx">value</span><span class="p">.</span><span class="nx">indexOf</span><span class="p">(</span><span class="s">&quot;</span><span class="err">#</span><span class="s">BusinessEntity&quot;</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="o">and</span> <span class="nx">annotation</span><span class="p">.</span><span class="nx">relation</span><span class="p">.</span><span class="nx">value</span> <span class="k">in</span> <span class="p">[</span><span class="s">&#39;http://connectme.at/ontology#explicitlyShows&#39;</span><span class="p">,</span> <span class="s">&#39;http://connectme.at/ontology#explicitlyMentions&#39;</span><span class="p">,</span> <span class="s">&#39;http://connectme.at/ontology#implicitlyShows&#39;</span> <span class="p">,</span> <span class="s">&#39;http://connectme.at/ontology#implicitlyMentions&#39;</span><span class="p">,</span> <span class="s">&#39;http://connectme.at/ontology#hasContent&#39;</span><span class="p">]</span></pre></div></td></tr><tr id="section-2"><td class="docs"><div class="pilwrap"><a href="#section-2" class="pilcrow">&#182;</a></div><p>if annotation.resource.value.indexOf("geonames") &lt; 0 &amp;&amp; annotation.resource.value.indexOf("dbpedia") &lt; 0 &amp;&amp; annotation.resource.value.indexOf("youtube") &lt; 0</p>
</td><td class="code"><div class="highlight"><pre>        <span class="nx">@handleAnnotation</span> <span class="nx">annotation</span></pre></div></td></tr><tr id="section-3"><td class="docs"><div class="pilwrap"><a href="#section-3" class="pilcrow">&#182;</a></div><p>Putting this into a function keeps the annotation in the context</p>
</td><td class="code"><div class="highlight"><pre>  <span class="nv">handleAnnotation: </span><span class="nf">(annotation) -&gt;</span></pre></div></td></tr><tr id="section-4"><td class="docs"><div class="pilwrap"><a href="#section-4" class="pilcrow">&#182;</a></div><p>console.info "The annotation #{annotation.resource} looks interesting, get the whole entity so we can show it in a widget!", annotation
annotation.entityPromise.done (entities) =>
console.info "entities for annotation #{annotation.resource} loaded, create a widget for it!", annotation</p>
</td><td class="code"><div class="highlight"><pre>    <span class="nx">$</span><span class="p">.</span><span class="nx">getJSON</span> <span class="s">&quot;http://smart-ip.net/geoip-json?callback=?&quot;</span><span class="p">,</span> <span class="p">(</span><span class="nx">data</span><span class="p">)</span> <span class="o">=&gt;</span>
      <span class="vi">@clientIP = </span> <span class="nx">data</span><span class="p">.</span><span class="nx">host</span>


    <span class="nx">@getGRData</span> <span class="nx">annotation</span>
    <span class="nv">nonConcept = </span><span class="nx">annotation</span><span class="p">.</span><span class="nx">resource</span><span class="p">.</span><span class="nx">value</span></pre></div></td></tr><tr id="section-5"><td class="docs"><div class="pilwrap"><a href="#section-5" class="pilcrow">&#182;</a></div><p>nonConcept = nonConcept.replace("No description found.","")</p>
</td><td class="code"><div class="highlight"><pre>    <span class="k">if</span><span class="p">(</span><span class="nx">nonConcept</span><span class="p">.</span><span class="nx">length</span> <span class="o">&gt;=</span> <span class="mi">3</span><span class="p">)</span>
      <span class="nv">url = </span><span class="nx">annotation</span><span class="p">.</span><span class="nx">resource</span><span class="p">.</span><span class="nx">value</span><span class="p">;</span>
      <span class="nv">domain = </span><span class="nx">url</span><span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="s">&#39;http://&#39;</span><span class="p">,</span><span class="s">&#39;&#39;</span><span class="p">).</span><span class="nx">replace</span><span class="p">(</span><span class="s">&#39;https://&#39;</span><span class="p">,</span><span class="s">&#39;&#39;</span><span class="p">).</span><span class="nx">split</span><span class="p">(</span><span class="sr">/[/?#]/</span><span class="p">)[</span><span class="mi">0</span><span class="p">].</span><span class="nx">replace</span><span class="p">(</span><span class="s">&#39;www.&#39;</span><span class="p">,</span> <span class="s">&#39;&#39;</span><span class="p">)</span>

      <span class="nv">widget = </span><span class="nx">@lime</span><span class="p">.</span><span class="nx">allocateWidgetSpace</span> <span class="nx">@</span><span class="p">,</span>
        <span class="nv">thumbnail: </span><span class="s">&quot;img/shop.png&quot;</span> <span class="c1"># should go into CSS</span>
        <span class="nv">title: </span><span class="s">&quot;</span><span class="si">#{</span><span class="nx">domain</span><span class="si">}</span><span class="s"> offer&quot;</span>
        <span class="nv">type: </span><span class="s">&quot;BusinessWidget&quot;</span>
        <span class="nv">sortBy: </span><span class="o">-&gt;</span>
          <span class="mi">10000</span> <span class="o">*</span> <span class="nx">annotation</span><span class="p">.</span><span class="nx">start</span> <span class="o">+</span> <span class="nx">annotation</span><span class="p">.</span><span class="nx">end</span></pre></div></td></tr><tr id="section-6"><td class="docs"><div class="pilwrap"><a href="#section-6" class="pilcrow">&#182;</a></div><p>We're going to need the annotation for the widget's <code>activate</code> event</p>
</td><td class="code"><div class="highlight"><pre>      <span class="nv">widget.annotation = </span><span class="nx">annotation</span></pre></div></td></tr><tr id="section-7"><td class="docs"><div class="pilwrap"><a href="#section-7" class="pilcrow">&#182;</a></div><p>widget was activated, we show details now</p>
</td><td class="code"><div class="highlight"><pre>      <span class="nx">jQuery</span><span class="p">(</span><span class="nx">widget</span><span class="p">).</span><span class="nx">bind</span> <span class="s">&#39;activate&#39;</span><span class="p">,</span> <span class="p">(</span><span class="nx">e</span><span class="p">)</span> <span class="o">=&gt;</span>
        <span class="nx">@expandWidget</span> <span class="nx">annotation</span><span class="p">,</span> <span class="nx">@getModalContainer</span><span class="p">()</span></pre></div></td></tr><tr id="section-8"><td class="docs"><div class="pilwrap"><a href="#section-8" class="pilcrow">&#182;</a></div><p>Hang the widget on the annotation</p>
</td><td class="code"><div class="highlight"><pre>      <span class="nx">annotation</span><span class="p">.</span><span class="nx">widgets</span><span class="p">[</span><span class="nx">@name</span><span class="p">]</span> <span class="o">=</span> <span class="nx">widget</span>

      <span class="nx">jQuery</span><span class="p">(</span><span class="nx">annotation</span><span class="p">).</span><span class="nx">bind</span> <span class="s">&quot;becomeActive&quot;</span><span class="p">,</span> <span class="p">(</span><span class="nx">e</span><span class="p">)</span> <span class="o">=&gt;</span>
        <span class="k">if</span><span class="p">(</span><span class="nx">annotation</span><span class="p">.</span><span class="nx">goodRelationsDataResource</span><span class="p">)</span>
          <span class="k">if</span><span class="p">(</span><span class="nx">annotation</span><span class="p">.</span><span class="nx">goodRelationsDataResource</span><span class="p">.</span><span class="nx">length</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span>
            <span class="nx">annotation</span><span class="p">.</span><span class="nx">widgets</span><span class="p">[</span><span class="nx">@name</span><span class="p">].</span><span class="nx">setActive</span><span class="p">()</span>

      <span class="nx">jQuery</span><span class="p">(</span><span class="nx">annotation</span><span class="p">).</span><span class="nx">bind</span> <span class="s">&quot;becomeInactive&quot;</span><span class="p">,</span> <span class="p">(</span><span class="nx">e</span><span class="p">)</span> <span class="o">=&gt;</span>
        <span class="nx">annotation</span><span class="p">.</span><span class="nx">widgets</span><span class="p">[</span><span class="nx">@name</span><span class="p">].</span><span class="nx">setInactive</span><span class="p">()</span>

      <span class="nx">jQuery</span><span class="p">(</span><span class="nx">widget</span><span class="p">).</span><span class="nx">bind</span> <span class="s">&quot;downarrow&quot;</span><span class="p">,</span> <span class="p">(</span><span class="nx">e</span><span class="p">)</span> <span class="o">=&gt;</span>
        <span class="vi">@bookingtabsiterator = </span><span class="k">if</span> <span class="mi">3</span> <span class="o">is</span> <span class="nx">@bookingtabsiterator</span> <span class="o">+</span> <span class="mi">1</span> <span class="k">then</span> <span class="mi">0</span> <span class="k">else</span> <span class="nx">@bookingtabsiterator</span> <span class="o">+</span> <span class="mi">1</span>

        <span class="k">if</span> <span class="p">(</span><span class="nx">@bookingtabsiterator</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span>
          <span class="nx">$</span><span class="p">(</span><span class="s">&quot;</span><span class="err">#</span><span class="s">businessWho&quot;</span><span class="p">).</span><span class="nx">trigger</span> <span class="s">&#39;click&#39;</span>
          <span class="nx">$</span><span class="p">(</span><span class="s">&quot;</span><span class="err">#</span><span class="s">businessWho&quot;</span><span class="p">).</span><span class="nx">addClass</span> <span class="s">&#39;selected&#39;</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">@bookingtabsiterator</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span>
          <span class="nx">$</span><span class="p">(</span><span class="s">&quot;</span><span class="err">#</span><span class="s">businessWhat&quot;</span><span class="p">).</span><span class="nx">trigger</span> <span class="s">&#39;click&#39;</span>
          <span class="nx">$</span><span class="p">(</span><span class="s">&quot;</span><span class="err">#</span><span class="s">businessWhat&quot;</span><span class="p">).</span><span class="nx">addClass</span> <span class="s">&#39;selected&#39;</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">@bookingtabsiterator</span> <span class="o">==</span> <span class="mi">2</span><span class="p">)</span>
          <span class="nx">$</span><span class="p">(</span><span class="s">&quot;</span><span class="err">#</span><span class="s">businessWhere&quot;</span><span class="p">).</span><span class="nx">trigger</span> <span class="s">&#39;click&#39;</span>
          <span class="nx">$</span><span class="p">(</span><span class="s">&quot;</span><span class="err">#</span><span class="s">businessWhere&quot;</span><span class="p">).</span><span class="nx">addClass</span> <span class="s">&#39;selected&#39;</span>


    <span class="nx">jQuery</span><span class="p">(</span><span class="nx">widget</span><span class="p">).</span><span class="nx">bind</span> <span class="s">&quot;uparrow&quot;</span><span class="p">,</span> <span class="p">(</span><span class="nx">e</span><span class="p">)</span> <span class="o">=&gt;</span>
      <span class="vi">@bookingtabsiterator = </span><span class="k">if</span> <span class="nx">@bookingtabsiterator</span> <span class="o">is</span> <span class="mi">0</span> <span class="k">then</span> <span class="mi">2</span>  <span class="k">else</span> <span class="nx">@bookingtabsiterator</span> <span class="o">-</span> <span class="mi">1</span>
      <span class="nx">$</span><span class="p">(</span><span class="s">&#39;.videotab.selected&#39;</span><span class="p">).</span><span class="nx">removeClass</span> <span class="s">&#39;selected&#39;</span>
      <span class="k">if</span> <span class="p">(</span><span class="nx">@bookingtabsiterator</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span>
        <span class="nx">$</span><span class="p">(</span><span class="s">&quot;</span><span class="err">#</span><span class="s">businessWho&quot;</span><span class="p">).</span><span class="nx">trigger</span> <span class="s">&#39;click&#39;</span>
        <span class="nx">$</span><span class="p">(</span><span class="s">&quot;</span><span class="err">#</span><span class="s">businessWho&quot;</span><span class="p">).</span><span class="nx">addClass</span> <span class="s">&#39;selected&#39;</span>
      <span class="k">if</span> <span class="p">(</span><span class="nx">@bookingtabsiterator</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span>
        <span class="nx">$</span><span class="p">(</span><span class="s">&quot;</span><span class="err">#</span><span class="s">businessWhat&quot;</span><span class="p">).</span><span class="nx">trigger</span> <span class="s">&#39;click&#39;</span>
        <span class="nx">$</span><span class="p">(</span><span class="s">&quot;</span><span class="err">#</span><span class="s">businessWhat&quot;</span><span class="p">).</span><span class="nx">addClass</span> <span class="s">&#39;selected&#39;</span>
      <span class="k">if</span> <span class="p">(</span><span class="nx">@bookingtabsiterator</span> <span class="o">==</span> <span class="mi">2</span><span class="p">)</span>
        <span class="nx">$</span><span class="p">(</span><span class="s">&quot;</span><span class="err">#</span><span class="s">businessWhere&quot;</span><span class="p">).</span><span class="nx">trigger</span> <span class="s">&#39;click&#39;</span>
        <span class="nx">$</span><span class="p">(</span><span class="s">&quot;</span><span class="err">#</span><span class="s">businessWhere&quot;</span><span class="p">).</span><span class="nx">addClass</span> <span class="s">&#39;selected&#39;</span>

  <span class="nv">getGRData: </span><span class="nf">(annotation) -&gt;</span>
    <span class="nx">@lime</span><span class="p">.</span><span class="nx">cmf</span><span class="p">.</span><span class="nx">getGRDataForTerm</span> <span class="nx">annotation</span><span class="p">.</span><span class="nx">resource</span><span class="p">.</span><span class="nx">value</span><span class="p">,</span> <span class="p">(</span><span class="nx">err</span><span class="p">,</span> <span class="nx">res</span><span class="p">)</span> <span class="o">=&gt;</span>
      <span class="k">if</span> <span class="nx">err</span>
        <span class="nx">console</span><span class="p">.</span><span class="nx">warn</span> <span class="s">&quot;Error getting CMF Good Relations resources&quot;</span><span class="p">,</span> <span class="nx">err</span>
      <span class="k">else</span>
        <span class="nv">annotation.goodRelationsDataResource = </span><span class="nx">_</span><span class="p">(</span><span class="nx">res</span><span class="p">).</span><span class="nx">map</span> <span class="nf">(resultset) -&gt;</span>
          <span class="nv">entity =</span>
            <span class="nv">name: </span><span class="nx">resultset</span><span class="p">.</span><span class="nx">name</span><span class="p">.</span><span class="nx">value</span>
            <span class="nv">street: </span><span class="nx">resultset</span><span class="p">.</span><span class="nx">street</span><span class="p">.</span><span class="nx">value</span>
            <span class="nv">pcode: </span><span class="nb">Number</span><span class="p">(</span><span class="nx">resultset</span><span class="p">.</span><span class="nx">pcode</span><span class="p">.</span><span class="nx">value</span><span class="p">)</span>
            <span class="nv">city: </span><span class="nx">resultset</span><span class="p">.</span><span class="nx">city</span><span class="p">.</span><span class="nx">value</span>
            <span class="nv">country: </span><span class="nx">resultset</span><span class="p">.</span><span class="nx">country</span><span class="p">.</span><span class="nx">value</span>
            <span class="nv">telephone: </span><span class="nx">resultset</span><span class="p">.</span><span class="nx">telephone</span><span class="p">.</span><span class="nx">value</span>
            <span class="nv">email: </span><span class="nx">resultset</span><span class="p">.</span><span class="nx">email</span><span class="p">.</span><span class="nx">value</span>
            <span class="nv">description: </span><span class="nx">resultset</span><span class="p">.</span><span class="nx">description</span><span class="p">.</span><span class="nx">value</span>
            <span class="nv">geoLat: </span><span class="nb">Number</span><span class="p">(</span><span class="nx">resultset</span><span class="p">.</span><span class="nx">geoLat</span><span class="p">.</span><span class="nx">value</span><span class="p">)</span>
            <span class="nv">geoLong: </span><span class="nb">Number</span><span class="p">(</span><span class="nx">resultset</span><span class="p">.</span><span class="nx">geoLong</span><span class="p">.</span><span class="nx">value</span><span class="p">)</span>
            <span class="nv">priceValue: </span><span class="nb">Number</span><span class="p">(</span><span class="nx">resultset</span><span class="p">.</span><span class="nx">pricevalue</span><span class="p">.</span><span class="nx">value</span><span class="p">)</span>
            <span class="nv">priceCurrency: </span><span class="nx">resultset</span><span class="p">.</span><span class="nx">pricecurrency</span><span class="p">.</span><span class="nx">value</span>
            <span class="nv">product: </span><span class="nx">resultset</span><span class="p">.</span><span class="nx">product</span><span class="p">.</span><span class="nx">value</span>
          <span class="nx">entity</span>

        <span class="nv">annotation.getGRDataResource = </span><span class="o">-&gt;</span>
          <span class="nx">@goodRelationsDataResource</span>

  <span class="nv">_htmlEncode: </span><span class="nf">(str) -&gt;</span>
    <span class="nx">str</span><span class="p">.</span><span class="nx">replace</span> <span class="sr">/[&amp;&lt;&gt;&quot;&#39;]/g</span><span class="p">,</span> <span class="nf">($0) -&gt;</span>
      <span class="s">&quot;&amp;&quot;</span> <span class="o">+</span> <span class="p">{</span><span class="s">&quot;&amp;&quot;</span><span class="o">:</span><span class="s">&quot;amp&quot;</span><span class="p">,</span> <span class="s">&quot;&lt;&quot;</span><span class="o">:</span><span class="s">&quot;lt&quot;</span><span class="p">,</span> <span class="s">&quot;&gt;&quot;</span><span class="o">:</span><span class="s">&quot;gt&quot;</span><span class="p">,</span> <span class="s">&#39;&quot;&#39;</span><span class="o">:</span><span class="s">&quot;quot&quot;</span><span class="p">,</span> <span class="s">&quot;&#39;&quot;</span><span class="o">:</span><span class="s">&quot;</span><span class="err">#</span><span class="s">39&quot;</span><span class="p">}[</span><span class="nx">$0</span><span class="p">]</span> <span class="o">+</span> <span class="s">&quot;;&quot;</span>

  <span class="nv">expandWidget: </span><span class="nf">(annotation, outputElement) -&gt;</span>
    <span class="nv">modalContent = </span><span class="nx">$</span><span class="p">(</span><span class="nx">outputElement</span><span class="p">)</span>
    <span class="nx">modalContent</span><span class="p">.</span><span class="nx">css</span> <span class="s">&quot;width&quot;</span><span class="p">,</span> <span class="s">&quot;600px&quot;</span>
    <span class="nx">modalContent</span><span class="p">.</span><span class="nx">css</span> <span class="s">&quot;height&quot;</span><span class="p">,</span> <span class="s">&quot;auto&quot;</span></pre></div></td></tr><tr id="section-9"><td class="docs"><div class="pilwrap"><a href="#section-9" class="pilcrow">&#182;</a></div><p>console.log("latitude: " + latitude + " longitude: " + longitude + " = latlong: " + latlng);</p>
</td><td class="code"><div class="highlight"><pre>    <span class="nv">lime = </span><span class="k">this</span><span class="p">.</span><span class="nx">lime</span>
    <span class="nv">resource = </span><span class="s">&quot;&quot;</span>
    <span class="nv">resource = </span><span class="nx">annotation</span><span class="p">.</span><span class="nx">resource</span><span class="p">.</span><span class="nx">value</span>
    <span class="nv">startTime = </span><span class="k">new</span> <span class="nb">Date</span><span class="p">().</span><span class="nx">getTime</span><span class="p">()</span></pre></div></td></tr><tr id="section-10"><td class="docs"><div class="pilwrap"><a href="#section-10" class="pilcrow">&#182;</a></div><p>if annotation.resource.value.indexOf("webtv.feratel.com") > 0
resource = resource.replace /\$\$/g, "&amp;"</p>
</td><td class="code"><div class="highlight"><pre>    <span class="nv">businessData = </span><span class="nx">annotation</span><span class="p">.</span><span class="nx">getGRDataResource</span><span class="p">()</span>

    <span class="k">if</span><span class="p">(</span><span class="nx">businessData</span><span class="p">.</span><span class="nx">length</span><span class="p">)</span>
      <span class="k">if</span><span class="p">(</span><span class="nx">businessData</span><span class="p">.</span><span class="nx">length</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span></pre></div></td></tr><tr id="section-11"><td class="docs"><div class="pilwrap"><a href="#section-11" class="pilcrow">&#182;</a></div><p>result = "<div id=\"listContainer\" style=\"position:relative; float: left; z-index: 10; width:35%; height: 95%; background: white; box-shadow: rgba(85,85,85,0.5) 0px 0px 24px;\" >" + "<img src=\"" + depiction + "\" style=\"display: block; width: auto; max-height: 300px; max-width:90%; margin-top: 30px; margin-left: auto;  margin-right: auto; border: 5px solid black; \" >" + "</div>" + "<div id=\"displayArea\" style=\"position:relative; float: left; z-index: 1; width: 65%; height:95%; background: #DBDBDB; overflow: auto;\">" + "<p style=\"margin-left: 10px; font-size: 22px; text-align: left; color:black; font-family: 'Share Tech', sans-serif; font-weight: 400;\">" + comment + "</p>" + "</div>";</p>
</td><td class="code"><div class="highlight"><pre>        <span class="nv">result = </span><span class="s">&quot;&quot;&quot;</span>
<span class="s">                 &lt;div id=&quot;bookingWidgetExpanded&quot; style=&quot;position: relative; z-index: 900; width: 600px; height: 600px; background-color: transparent;&quot;&gt;</span>
<span class="s">                 &lt;div id=&quot;forthTile&quot; style=&quot;position: relative; float: left; width: 300px; height: 300px;&quot;&gt;</span>
<span class="s">                 &lt;div style=&quot;width: 100%; position: relative; height: 30px; font-size: 20px; color: </span><span class="err">#</span><span class="s">00BFFF; background-color: </span><span class="err">#</span><span class="s">696969;&quot;&gt;</span>
<span class="s">                 </span><span class="si">#{</span><span class="nx">businessData</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="nx">name</span><span class="si">}</span><span class="s"></span>
<span class="s">                 &lt;/div&gt;</span>
<span class="s">                 &lt;div style=&quot;width: 100%; position: relative; font-size: 16px; height: 50px; background-color: </span><span class="err">#</span><span class="s">303030; color: </span><span class="err">#</span><span class="s">f1f1f1;&quot;&gt;</span>
<span class="s">                 </span><span class="si">#{</span><span class="nx">businessData</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="nx">street</span><span class="si">}</span><span class="s">, </span><span class="si">#{</span><span class="nx">businessData</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="nx">pcode</span><span class="si">}</span><span class="s"> </span><span class="si">#{</span><span class="nx">businessData</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="nx">city</span><span class="si">}</span><span class="s">, </span><span class="si">#{</span><span class="nx">businessData</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="nx">country</span><span class="si">}</span><span class="s"></span>
<span class="s">                 &lt;/div&gt;</span>
<span class="s">                 &lt;div style=&quot;width: 100%; position: relative; height: 20px; font-size: 16px; background-color: </span><span class="err">#</span><span class="s">303030; color: </span><span class="err">#</span><span class="s">f1f1f1; text-align: center;&quot;&gt;</span>
<span class="s">                  </span><span class="si">#{</span><span class="nx">businessData</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="nx">telephone</span><span class="si">}</span><span class="s"></span>
<span class="s">                 &lt;/div&gt;</span>
<span class="s">                 &lt;div style=&quot;width: 100%; position: relative; height: 170px; font-size: 16px; background-color: </span><span class="err">#</span><span class="s">303030; color: </span><span class="err">#</span><span class="s">f1f1f1; overflow-y: scroll;&quot;&gt;</span>
<span class="s">                 Über uns&lt;br&gt;</span>
<span class="s">                 </span><span class="si">#{</span><span class="nx">businessData</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="nx">description</span><span class="si">}</span><span class="s"></span>
<span class="s">                 &lt;/div&gt;</span>
<span class="s">                 &lt;div class=&quot;businessContact&quot;  style=&quot;cursor: hand; cursor: pointer; width: 100%; position: relative; height: 30px; color: black; background-color: lightgray; font-size: 21px; text-align: center; background-image: -webkit-gradient(radial, center center, 10, center center, from(white), to(</span><span class="err">#</span><span class="s">909090)); background-image: -o-radial-gradient(white, </span><span class="err">#</span><span class="s">909090); background-image: -ms-radial-gradient(white, </span><span class="err">#</span><span class="s">909090); background-image: -moz-radial-gradient(white, </span><span class="err">#</span><span class="s">909090); background-image: -webkit-radial-gradient(white, </span><span class="err">#</span><span class="s">909090); background-image: radial-gradient(white, </span><span class="err">#</span><span class="s">909090);&quot;&gt;</span>
<span class="s">                 kontaktieren Sie uns</span>
<span class="s">                 &lt;/div&gt;</span>
<span class="s">                 &lt;/div&gt;</span>

<span class="s">                 &lt;div id=&quot;secondTile&quot; style=&quot;width: 300px; height: 300px; position: relative; float: left; display: none;&quot;&gt;</span>
<span class="s">                 &lt;div id=&quot;businessName&quot; style=&quot;width: 100%; position: relative; height: 30px; font-size: 20px; color: </span><span class="err">#</span><span class="s">FA8072; background-color: </span><span class="err">#</span><span class="s">696969;&quot;&gt;</span>
<span class="s">                  </span><span class="si">#{</span><span class="nx">businessData</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="nx">name</span><span class="si">}</span><span class="s"></span>
<span class="s">                 &lt;/div&gt;</span>
<span class="s">                 &lt;div id=&quot;businessAddress&quot; style=&quot;width: 100%; position: relative; font-size: 16px; height: 50px; background-color: </span><span class="err">#</span><span class="s">303030; color: </span><span class="err">#</span><span class="s">f1f1f1;&quot;&gt;</span>
<span class="s">                  </span><span class="si">#{</span><span class="nx">businessData</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="nx">street</span><span class="si">}</span><span class="s">, </span><span class="si">#{</span><span class="nx">businessData</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="nx">pcode</span><span class="si">}</span><span class="s"> </span><span class="si">#{</span><span class="nx">businessData</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="nx">city</span><span class="si">}</span><span class="s">, </span><span class="si">#{</span><span class="nx">businessData</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="nx">country</span><span class="si">}</span><span class="s"></span>
<span class="s">                 &lt;/div&gt;</span>
<span class="s">                 &lt;div id=&quot;businessTelephone&quot; style=&quot;width: 100%; position: relative; height: 20px; font-size: 16px; background-color: </span><span class="err">#</span><span class="s">303030; color: </span><span class="err">#</span><span class="s">f1f1f1; text-align: center;&quot;&gt;</span>
<span class="s">                  </span><span class="si">#{</span><span class="nx">businessData</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="nx">telephone</span><span class="si">}</span><span class="s"></span>
<span class="s">                 &lt;/div&gt;</span>
<span class="s">                 &lt;div id=&quot;businessService&quot; style=&quot;width: 100%; position: relative; height: 110px; background-color: </span><span class="err">#</span><span class="s">ffffff;&quot;&gt;</span>
<span class="s">                 &lt;div id=&quot;businessService1&quot; style=&quot;width: 100%; height: 80px; font-size: 16px; background-color: </span><span class="err">#</span><span class="s">696969; position: relative; overflow-y: scroll;&quot;&gt;</span>
<span class="s">                  </span><span class="si">#{</span><span class="nx">businessData</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="nx">product</span><span class="si">}</span><span class="s"></span>
<span class="s">                 &lt;/div&gt;</span>
<span class="s">                 &lt;div id=&quot;businessService2&quot; style=&quot;width: 100%; height: 30px; font-size: 16px; background-color: </span><span class="err">#</span><span class="s">303030; position: relative;&quot;&gt;</span>
<span class="s">                  </span><span class="si">#{</span><span class="nx">businessData</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="nx">priceValue</span><span class="si">}</span><span class="s"> </span><span class="si">#{</span><span class="nx">businessData</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="nx">priceCurrency</span><span class="si">}</span><span class="s"></span>
<span class="s">                 &lt;/div&gt;</span>
<span class="s">                 &lt;div id=&quot;businessService3&quot; style=&quot;width: 100%; height: 20px; position: relative; display: none;&quot;&gt;</span>
<span class="s">                 Service 3 - Price XXXX EUR</span>
<span class="s">                 &lt;/div&gt;</span>
<span class="s">                 &lt;div id=&quot;businessService4&quot; style=&quot;width: 100%; height: 20px; position: relative; display: none;&quot;&gt;</span>
<span class="s">                 Service 4 - Price XXXX EUR</span>
<span class="s">                 &lt;/div&gt;</span>
<span class="s">                 &lt;div id=&quot;businessService5&quot; style=&quot;width: 100%; height: 20px; position: relative; display: none;&quot;&gt;</span>
<span class="s">                 Service 5 - Price XXXX EUR</span>
<span class="s">                 &lt;/div&gt;</span>
<span class="s">                 &lt;/div&gt;</span>
<span class="s">                 &lt;div id=&quot;businessOpeningHours&quot; style=&quot;width: 100%; position: relative; height: 60px; background-color: </span><span class="err">#</span><span class="s">303030; color: </span><span class="err">#</span><span class="s">f1f1f1;&quot;&gt;</span>
<span class="s">                 </span>
<span class="s">                 &lt;/div&gt;</span>
<span class="s">                   &lt;div class=&quot;businessContact&quot; style=&quot;cursor: hand; cursor: pointer; width: 100%; position: relative; height: 30px; color: black; background-color: lightgray; font-size: 21px; text-align: center; background-image: -webkit-gradient(radial, center center, 10, center center, from(white), to(</span><span class="err">#</span><span class="s">909090)); background-image: -o-radial-gradient(white, </span><span class="err">#</span><span class="s">909090); background-image: -ms-radial-gradient(white, </span><span class="err">#</span><span class="s">909090); background-image: -moz-radial-gradient(white, </span><span class="err">#</span><span class="s">909090); background-image: -webkit-radial-gradient(white, </span><span class="err">#</span><span class="s">909090); background-image: radial-gradient(white, </span><span class="err">#</span><span class="s">909090);&quot;&gt;</span>
<span class="s">                 kontaktieren Sie uns</span>
<span class="s">                   &lt;/div&gt;</span>
<span class="s">                 &lt;/div&gt;</span>

<span class="s">                 &lt;div id=&quot;firstTile&quot; style=&quot;position: relative; float: left; width: 300px; height: 300px; display: none;&quot;&gt;</span>
<span class="s">                 &lt;div style=&quot;width: 100%; position: relative; height: 30px; font-size: 20px; background-color: </span><span class="err">#</span><span class="s">696969; color: </span><span class="err">#</span><span class="s">90EE90;&quot;&gt;</span>
<span class="s">                 </span><span class="si">#{</span><span class="nx">businessData</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="nx">name</span><span class="si">}</span><span class="s"></span>
<span class="s">                 &lt;/div&gt;</span>
<span class="s">                 &lt;div id=&quot;map&quot; style=&quot;width: 100%; height: 270px; position: absolute; z-index: 900; height: 89%; background-color: green;&quot;&gt;&lt;/div&gt;</span>
<span class="s">                 &lt;/div&gt;</span>

<span class="s">                 &lt;div id=&quot;thirdTile&quot; style=&quot;width: 298px; height: 300px; float: left; position: relative; border-left:dotted 1px </span><span class="err">#</span><span class="s">bbbbbb&quot;&gt;</span>
<span class="s">                 &lt;div id=&quot;businessWho&quot; class=&quot;bookingtab&quot; style=&quot;cursor: hand; cursor: pointer; width: 98%; height: 98px; position: relative; float: left; background-color: </span><span class="err">#</span><span class="s">696969; color: </span><span class="err">#</span><span class="s">00BFFF; font-size: 49px; border-bottom:dotted 1px </span><span class="err">#</span><span class="s">bbbbbb; border-right:dotted 1px </span><span class="err">#</span><span class="s">bbbbbb&quot; &gt;</span>
<span class="s">                 Wie?</span>
<span class="s">                 &lt;div id=&quot;businessWhoLabel&quot; style=&quot;cursor: hand; cursor: pointer; position: absolute; z-index: 900; left: 0px; bottom: 0px; height: 50%; width: 100%; font-size: 14pt; color: white; background-color: </span><span class="err">#</span><span class="s">303030;&quot;&gt;</span>
<span class="s">                 Über uns</span>
<span class="s">                 &lt;/div&gt;</span>
<span class="s">                 &lt;/div&gt;</span>
<span class="s">                 &lt;div id=&quot;businessWhat&quot; class=&quot;bookingtab&quot; style=&quot;cursor: hand; cursor: pointer; width: 98%; height: 98px; float: left; position: relative; background-color: </span><span class="err">#</span><span class="s">696969; color: </span><span class="err">#</span><span class="s">FA8072; font-size: 49px; border-bottom:dotted 1px </span><span class="err">#</span><span class="s">bbbbbb; border-right:dotted 1px </span><span class="err">#</span><span class="s">bbbbbb&quot;&gt;</span>
<span class="s">                 Was?</span>
<span class="s">                 &lt;div id=&quot;businessWhatLabel&quot; style=&quot;cursor: hand; cursor: pointer; position: absolute; z-index: 900; left: 0px; bottom: 0px; height: 50%; width: 100%; font-size: 14pt; color: white; background-color: </span><span class="err">#</span><span class="s">303030;&quot;&gt;</span>
<span class="s">                 Unser Angebot</span>
<span class="s">                 &lt;/div&gt;</span>
<span class="s">                 &lt;/div&gt;</span>
<span class="s">                 &lt;div id=&quot;businessWhere&quot; class=&quot;bookingtab&quot; style=&quot;cursor: hand; cursor: pointer; width: 98%; height: 100px; position: relative; float: left; background-color: </span><span class="err">#</span><span class="s">696969; color: </span><span class="err">#</span><span class="s">90EE90; font-size: 49px; border-bottom:dotted 1px </span><span class="err">#</span><span class="s">bbbbbb; border-right:dotted 1px </span><span class="err">#</span><span class="s">bbbbbb&quot;&gt;</span>
<span class="s">                 Wo?</span>
<span class="s">                 &lt;div id=&quot;businessWhereLabel&quot; style=&quot;cursor: hand; cursor: pointer; position: absolute; z-index: 900; width: 100%; height: 50%; left: 0px; bottom: 0px; font-size: 14pt; color: white; background-color: </span><span class="err">#</span><span class="s">303030;&quot;&gt;</span>
<span class="s">                 Reiseroute Karte</span>
<span class="s">                 &lt;/div&gt;</span>
<span class="s">                 &lt;/div&gt;</span>
<span class="s">                 &lt;/div&gt;</span>

<span class="s">                 &lt;/div&gt;</span>

<span class="s">                 &quot;&quot;&quot;</span>
        <span class="nx">modalContent</span><span class="p">.</span><span class="nx">append</span> <span class="nx">result</span>
        <span class="vi">@bookingtabsiterator = </span><span class="mi">0</span></pre></div></td></tr><tr id="section-12"><td class="docs"><div class="pilwrap"><a href="#section-12" class="pilcrow">&#182;</a></div><p>widget controls</p>
</td><td class="code"><div class="highlight"><pre>        <span class="nx">$</span><span class="p">(</span><span class="s">&quot;.close&quot;</span><span class="p">).</span><span class="nx">click</span> <span class="p">(</span><span class="nx">e</span><span class="p">)</span> <span class="o">=&gt;</span>
          <span class="nv">endTime = </span><span class="k">new</span> <span class="nb">Date</span><span class="p">().</span><span class="nx">getTime</span><span class="p">()</span>
          <span class="nv">timeSpent = </span><span class="nx">endTime</span> <span class="o">-</span> <span class="nx">startTime</span>
          <span class="nv">eventLabel = </span><span class="nx">annotation</span><span class="p">.</span><span class="nx">widgets</span><span class="p">[</span><span class="nx">@</span><span class="p">.</span><span class="nx">name</span><span class="p">].</span><span class="nx">options</span><span class="p">.</span><span class="nx">title</span>
          <span class="nx">console</span><span class="p">.</span><span class="nx">log</span> <span class="s">&quot;: </span><span class="si">#{</span><span class="nx">eventLabel</span><span class="si">}</span><span class="s"> was viewed </span><span class="si">#{</span><span class="nx">timeSpent</span><span class="si">}</span><span class="s"> msec.&quot;</span>

        <span class="nx">$</span><span class="p">(</span><span class="s">&#39;#mask&#39;</span><span class="p">).</span><span class="nx">click</span> <span class="p">(</span><span class="nx">e</span><span class="p">)</span> <span class="o">=&gt;</span>
          <span class="nv">endTime = </span><span class="k">new</span> <span class="nb">Date</span><span class="p">().</span><span class="nx">getTime</span><span class="p">()</span>
          <span class="nv">timeSpent = </span><span class="nx">endTime</span> <span class="o">-</span> <span class="nx">startTime</span>
          <span class="nv">eventLabel = </span><span class="nx">annotation</span><span class="p">.</span><span class="nx">widgets</span><span class="p">[</span><span class="nx">@</span><span class="p">.</span><span class="nx">name</span><span class="p">].</span><span class="nx">options</span><span class="p">.</span><span class="nx">title</span>
          <span class="nx">console</span><span class="p">.</span><span class="nx">log</span> <span class="s">&quot;: </span><span class="si">#{</span><span class="nx">eventLabel</span><span class="si">}</span><span class="s"> was viewed </span><span class="si">#{</span><span class="nx">timeSpent</span><span class="si">}</span><span class="s"> msec.&quot;</span>

        <span class="nx">$</span><span class="p">(</span><span class="s">&quot;.businessContact&quot;</span><span class="p">).</span><span class="nx">click</span> <span class="o">=&gt;</span>
          <span class="nx">$</span><span class="p">(</span><span class="s">&quot;.businessContact&quot;</span><span class="p">).</span><span class="nx">text</span> <span class="s">&quot;Danke schön!&quot;</span>
          <span class="nv">grdata = </span><span class="nx">annotation</span><span class="p">.</span><span class="nx">getGRDataResource</span><span class="p">()</span>
          <span class="k">if</span><span class="p">(</span><span class="nx">grdata</span><span class="p">.</span><span class="nx">length</span><span class="p">)</span>
            <span class="k">if</span><span class="p">(</span><span class="nx">grdata</span><span class="p">.</span><span class="nx">length</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span>
              <span class="nv">time = </span><span class="nx">$</span><span class="p">.</span><span class="nx">now</span><span class="p">()</span>
              <span class="nv">bemail = </span><span class="nx">grdata</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="nx">email</span>
              <span class="nv">bname = </span><span class="nx">grdata</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="nx">name</span></pre></div></td></tr><tr id="section-13"><td class="docs"><div class="pilwrap"><a href="#section-13" class="pilcrow">&#182;</a></div><p>entry = @clientIP + ' clicked on '+ grdata[0].name
@_htmlEncode entry</p>
</td><td class="code"><div class="highlight"><pre>              <span class="nx">$</span><span class="p">.</span><span class="nx">post</span> <span class="s">&#39;http://devserver.sti2.org/connectme/logger.php?&#39;</span><span class="p">,</span>
                <span class="nv">entry : </span><span class="s">&quot;&quot;&quot;</span>
<span class="s">                        &lt;div  style=&quot;width: 100%; position: relative; float: left; background-color: </span><span class="err">#</span><span class="s">e1e1e1; height: 30px; border-bottom: 1px dotted </span><span class="err">#</span><span class="s">696969;&quot; class=&quot;item&quot;&gt;</span>
<span class="s">                        &lt;div style=&quot;height: 100%; color: </span><span class="err">#</span><span class="s">32CD32; font-size: 16pt; background-color: </span><span class="err">#</span><span class="s">505050; width: 30px; text-align: center; position: relative; float: left;&quot; class=&quot;icon&quot;&gt;</span>
<span class="s">                        @&lt;/div&gt;</span>
<span class="s">                            &lt;div style=&quot;width: 200px; height: 100%; position: relative; float: left; font-size: 16px; text-align: center; border-right: 1px dotted </span><span class="err">#</span><span class="s">696969;&quot; class=&quot;ip&quot;&gt;</span>
<span class="s">                </span><span class="si">#{</span><span class="nx">@clientIP</span><span class="si">}</span><span class="s">&lt;/div&gt;</span>
<span class="s">                            &lt;div style=&quot;width: 200px; height: 100%; position: relative; float: left; font-size: 16px; text-align: center; border-right: 1px dotted </span><span class="err">#</span><span class="s">696969;&quot; class=&quot;email&quot;&gt;</span>
<span class="s">                </span><span class="si">#{</span><span class="nx">bemail</span><span class="si">}</span><span class="s">l&lt;/div&gt;</span>
<span class="s">                            &lt;div style=&quot;width: 200px; height: 100%; position: relative; float: left; font-size: 16px; text-align: center; border-right: 1px dotted </span><span class="err">#</span><span class="s">696969;&quot; class=&quot;name&quot;&gt;</span>
<span class="s">                </span><span class="si">#{</span><span class="nx">bname</span><span class="si">}</span><span class="s">&lt;/div&gt;</span>
<span class="s">                            &lt;div style=&quot;width: 200px; height: 100%; position: relative; float: left; font-size: 16px; text-align: center; border-right: 1px dotted </span><span class="err">#</span><span class="s">696969;&quot; class=&quot;time&quot;&gt;</span>
<span class="s">                </span><span class="si">#{</span><span class="nx">time</span><span class="si">}</span><span class="s">&lt;/div&gt;</span>
<span class="s">                            &lt;/div&gt;</span>
<span class="s">                          &quot;&quot;&quot;</span>
                <span class="nf">(data) -&gt;</span>




        <span class="nx">$</span><span class="p">(</span><span class="s">&quot;</span><span class="err">#</span><span class="s">businessWho&quot;</span><span class="p">).</span><span class="nx">click</span> <span class="o">=&gt;</span>
          <span class="nx">$</span><span class="p">(</span><span class="s">&#39;.bookingtab.selected&#39;</span><span class="p">).</span><span class="nx">removeClass</span> <span class="s">&#39;selected&#39;</span>
          <span class="nx">$</span><span class="p">(</span><span class="s">&quot;</span><span class="err">#</span><span class="s">businessWho&quot;</span><span class="p">).</span><span class="nx">addClass</span> <span class="s">&quot;selected&quot;</span>

          <span class="nx">$</span><span class="p">(</span><span class="s">&quot;</span><span class="err">#</span><span class="s">forthTile&quot;</span><span class="p">).</span><span class="nx">css</span> <span class="s">&quot;display&quot;</span><span class="p">,</span> <span class="s">&quot;block&quot;</span>
          <span class="nx">$</span><span class="p">(</span><span class="s">&quot;</span><span class="err">#</span><span class="s">firstTile&quot;</span><span class="p">).</span><span class="nx">css</span> <span class="s">&quot;display&quot;</span><span class="p">,</span> <span class="s">&quot;none&quot;</span>
          <span class="nx">$</span><span class="p">(</span><span class="s">&quot;</span><span class="err">#</span><span class="s">secondTile&quot;</span><span class="p">).</span><span class="nx">css</span> <span class="s">&quot;display&quot;</span><span class="p">,</span> <span class="s">&quot;none&quot;</span>
          <span class="nx">$</span><span class="p">(</span><span class="s">&quot;</span><span class="err">#</span><span class="s">map&quot;</span><span class="p">).</span><span class="nx">empty</span><span class="p">()</span>


        <span class="nx">$</span><span class="p">(</span><span class="s">&quot;</span><span class="err">#</span><span class="s">businessWhat&quot;</span><span class="p">).</span><span class="nx">click</span> <span class="o">=&gt;</span>
          <span class="nx">$</span><span class="p">(</span><span class="s">&#39;.bookingtab.selected&#39;</span><span class="p">).</span><span class="nx">removeClass</span> <span class="s">&#39;selected&#39;</span>
          <span class="nx">$</span><span class="p">(</span><span class="s">&quot;</span><span class="err">#</span><span class="s">businessWhat&quot;</span><span class="p">).</span><span class="nx">addClass</span> <span class="s">&quot;selected&quot;</span>

          <span class="nx">$</span><span class="p">(</span><span class="s">&quot;</span><span class="err">#</span><span class="s">forthTile&quot;</span><span class="p">).</span><span class="nx">css</span> <span class="s">&quot;display&quot;</span><span class="p">,</span> <span class="s">&quot;none&quot;</span>
          <span class="nx">$</span><span class="p">(</span><span class="s">&quot;</span><span class="err">#</span><span class="s">firstTile&quot;</span><span class="p">).</span><span class="nx">css</span> <span class="s">&quot;display&quot;</span><span class="p">,</span> <span class="s">&quot;none&quot;</span>
          <span class="nx">$</span><span class="p">(</span><span class="s">&quot;</span><span class="err">#</span><span class="s">secondTile&quot;</span><span class="p">).</span><span class="nx">css</span> <span class="s">&quot;display&quot;</span><span class="p">,</span> <span class="s">&quot;block&quot;</span>
          <span class="nx">$</span><span class="p">(</span><span class="s">&quot;</span><span class="err">#</span><span class="s">map&quot;</span><span class="p">).</span><span class="nx">empty</span><span class="p">()</span>


        <span class="nx">$</span><span class="p">(</span><span class="s">&quot;</span><span class="err">#</span><span class="s">businessWhere&quot;</span><span class="p">).</span><span class="nx">click</span> <span class="o">=&gt;</span>
          <span class="nx">$</span><span class="p">(</span><span class="s">&#39;.bookingtab.selected&#39;</span><span class="p">).</span><span class="nx">removeClass</span> <span class="s">&#39;selected&#39;</span>
          <span class="nx">$</span><span class="p">(</span><span class="s">&quot;</span><span class="err">#</span><span class="s">businessWhere&quot;</span><span class="p">).</span><span class="nx">addClass</span> <span class="s">&quot;selected&quot;</span>

          <span class="nx">$</span><span class="p">(</span><span class="s">&quot;</span><span class="err">#</span><span class="s">forthTile&quot;</span><span class="p">).</span><span class="nx">css</span> <span class="s">&quot;display&quot;</span><span class="p">,</span> <span class="s">&quot;none&quot;</span>
          <span class="nx">$</span><span class="p">(</span><span class="s">&quot;</span><span class="err">#</span><span class="s">firstTile&quot;</span><span class="p">).</span><span class="nx">css</span> <span class="s">&quot;display&quot;</span><span class="p">,</span> <span class="s">&quot;block&quot;</span>
          <span class="nx">$</span><span class="p">(</span><span class="s">&quot;</span><span class="err">#</span><span class="s">secondTile&quot;</span><span class="p">).</span><span class="nx">css</span> <span class="s">&quot;display&quot;</span><span class="p">,</span> <span class="s">&quot;none&quot;</span></pre></div></td></tr><tr id="section-14"><td class="docs"><div class="pilwrap"><a href="#section-14" class="pilcrow">&#182;</a></div><p>cartography handling</p>
</td><td class="code"><div class="highlight"><pre>          <span class="k">if</span> <span class="nx">navigator</span><span class="p">.</span><span class="nx">geolocation</span>
            <span class="nx">navigator</span><span class="p">.</span><span class="nx">geolocation</span><span class="p">.</span><span class="nx">getCurrentPosition</span> <span class="p">(</span><span class="nf">(position) -&gt;</span>
              <span class="nv">i = </span><span class="kc">undefined</span>
              <span class="nv">locationName = </span><span class="s">&quot;Planai - Hochwurzen&quot;</span></pre></div></td></tr><tr id="section-15"><td class="docs"><div class="pilwrap"><a href="#section-15" class="pilcrow">&#182;</a></div><p>annotation.getLabel()</p>
</td><td class="code"><div class="highlight"><pre>              <span class="nv">latitude = </span><span class="mf">47.392887</span></pre></div></td></tr><tr id="section-16"><td class="docs"><div class="pilwrap"><a href="#section-16" class="pilcrow">&#182;</a></div><p>annotation.getLatitude()</p>
</td><td class="code"><div class="highlight"><pre>              <span class="nv">longitude = </span><span class="mf">13.693318</span></pre></div></td></tr><tr id="section-17"><td class="docs"><div class="pilwrap"><a href="#section-17" class="pilcrow">&#182;</a></div><p>annotation.getLongitude()</p>
</td><td class="code"><div class="highlight"><pre>              <span class="nv">map = </span><span class="kc">undefined</span>
              <span class="nv">myOptions = </span><span class="kc">undefined</span>
              <span class="nv">output = </span><span class="kc">undefined</span>
              <span class="nv">x = </span><span class="kc">undefined</span>
              <span class="nv">xmlDoc = </span><span class="kc">undefined</span>
              <span class="nv">xmlhttp = </span><span class="kc">undefined</span>
              <span class="nv">start = </span><span class="kc">undefined</span>
              <span class="nv">destination = </span><span class="kc">undefined</span>
              <span class="nv">directionDisplay = </span><span class="kc">undefined</span>
              <span class="nv">directionsService = </span><span class="k">new</span> <span class="nx">google</span><span class="p">.</span><span class="nx">maps</span><span class="p">.</span><span class="nx">DirectionsService</span><span class="p">()</span>
              <span class="nv">grdata = </span><span class="nx">annotation</span><span class="p">.</span><span class="nx">getGRDataResource</span><span class="p">()</span>
              <span class="k">if</span><span class="p">(</span><span class="nx">grdata</span><span class="p">.</span><span class="nx">length</span><span class="p">)</span>
                 <span class="k">if</span><span class="p">(</span><span class="nx">grdata</span><span class="p">.</span><span class="nx">length</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span>
                    <span class="nv">latitude = </span><span class="nx">grdata</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="nx">geoLat</span></pre></div></td></tr><tr id="section-18"><td class="docs"><div class="pilwrap"><a href="#section-18" class="pilcrow">&#182;</a></div><p>annotation.getLatitude()</p>
</td><td class="code"><div class="highlight"><pre>                    <span class="nv">longitude = </span><span class="nx">grdata</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="nx">geoLong</span>
                    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span> <span class="s">&#39;latitude: &#39;</span><span class="p">,</span><span class="nx">latitude</span><span class="p">,</span> <span class="s">&#39; longitude:  &#39;</span><span class="p">,</span> <span class="nx">longitude</span></pre></div></td></tr><tr id="section-19"><td class="docs"><div class="pilwrap"><a href="#section-19" class="pilcrow">&#182;</a></div><p>annotation.getLongitude()</p>
</td><td class="code"><div class="highlight"><pre>              <span class="nv">output = </span><span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s">&quot;map&quot;</span><span class="p">)</span>
              <span class="nv">directionsDisplay = </span><span class="k">new</span> <span class="nx">google</span><span class="p">.</span><span class="nx">maps</span><span class="p">.</span><span class="nx">DirectionsRenderer</span><span class="p">()</span>
              <span class="nv">destination = </span><span class="k">new</span> <span class="nx">google</span><span class="p">.</span><span class="nx">maps</span><span class="p">.</span><span class="nx">LatLng</span><span class="p">(</span><span class="nx">latitude</span><span class="p">,</span> <span class="nx">longitude</span><span class="p">)</span>
              <span class="nv">mapOptions =</span>
                <span class="nv">zoom: </span><span class="mi">7</span>
                <span class="nv">mapTypeId: </span><span class="nx">google</span><span class="p">.</span><span class="nx">maps</span><span class="p">.</span><span class="nx">MapTypeId</span><span class="p">.</span><span class="nx">ROADMAP</span>
                <span class="nv">center: </span><span class="nx">destination</span>

              <span class="nv">map = </span><span class="k">new</span> <span class="nx">google</span><span class="p">.</span><span class="nx">maps</span><span class="p">.</span><span class="nx">Map</span><span class="p">(</span><span class="nx">output</span><span class="p">,</span> <span class="nx">mapOptions</span><span class="p">)</span>
              <span class="nv">start = </span><span class="k">new</span> <span class="nx">google</span><span class="p">.</span><span class="nx">maps</span><span class="p">.</span><span class="nx">LatLng</span><span class="p">(</span><span class="nx">position</span><span class="p">.</span><span class="nx">coords</span><span class="p">.</span><span class="nx">latitude</span><span class="p">,</span> <span class="nx">position</span><span class="p">.</span><span class="nx">coords</span><span class="p">.</span><span class="nx">longitude</span><span class="p">)</span></pre></div></td></tr><tr id="section-20"><td class="docs"><div class="pilwrap"><a href="#section-20" class="pilcrow">&#182;</a></div><p>set direction map
alert(start);</p>
</td><td class="code"><div class="highlight"><pre>              <span class="nx">directionsDisplay</span><span class="p">.</span><span class="nx">setMap</span> <span class="nx">map</span>
              <span class="vi">@geomap = </span><span class="nx">map</span>
              <span class="nv">request =</span>
                <span class="nv">origin: </span><span class="nx">start</span>
                <span class="nv">destination: </span><span class="nx">destination</span>
                <span class="nv">travelMode: </span><span class="nx">google</span><span class="p">.</span><span class="nx">maps</span><span class="p">.</span><span class="nx">TravelMode</span><span class="p">.</span><span class="nx">DRIVING</span>

              <span class="nx">directionsService</span><span class="p">.</span><span class="nx">route</span> <span class="nx">request</span><span class="p">,</span> <span class="nf">(result, status) -&gt;</span>
                <span class="nx">directionsDisplay</span><span class="p">.</span><span class="nx">setDirections</span> <span class="nx">result</span>  <span class="k">if</span> <span class="nx">status</span> <span class="o">is</span> <span class="nx">google</span><span class="p">.</span><span class="nx">maps</span><span class="p">.</span><span class="nx">DirectionsStatus</span><span class="p">.</span><span class="nx">OK</span></pre></div></td></tr><tr id="section-21"><td class="docs"><div class="pilwrap"><a href="#section-21" class="pilcrow">&#182;</a></div><p>next function is the error callback</p>
</td><td class="code"><div class="highlight"><pre>            <span class="p">),</span>
            <span class="nf">(error) -&gt;</span>
              <span class="k">switch</span> <span class="nx">error</span><span class="p">.</span><span class="nx">code</span>
                <span class="k">when</span> <span class="nx">error</span><span class="p">.</span><span class="nx">TIMEOUT</span>
                  <span class="nx">alert</span> <span class="s">&quot;Timeout&quot;</span>
                <span class="k">when</span> <span class="nx">error</span><span class="p">.</span><span class="nx">POSITION_UNAVAILABLE</span>
                  <span class="nx">alert</span> <span class="s">&quot;Position unavailable&quot;</span>
                <span class="k">when</span> <span class="nx">error</span><span class="p">.</span><span class="nx">PERMISSION_DENIED</span>
                  <span class="nx">alert</span> <span class="s">&quot;Permission denied&quot;</span>
                <span class="k">when</span> <span class="nx">error</span><span class="p">.</span><span class="nx">UNKNOWN_ERROR</span>
                  <span class="nx">alert</span> <span class="s">&quot;Unknown error&quot;</span>


        <span class="nx">$</span><span class="p">(</span><span class="s">&quot;</span><span class="err">#</span><span class="s">businessWho&quot;</span><span class="p">).</span><span class="nx">trigger</span> <span class="s">&quot;click&quot;</span>

</pre></div></td></tr></tbody></table><div id="projectname"><a href="../../index.html">LIME - Linked Media Player</a></div></div></body></html>